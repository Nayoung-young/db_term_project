{% extends "home.html" %}

{% block title %}movie{% endblock %}

{% block add_style %}
<style>
  #steps {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    justify-items: center;
    border: 1px solid black;
  }

  .col_body {
    display: flex;
    flex-direction: column;
  }

  #next_btn {
    grid-column: 1/-1;
  }
</style>
{% endblock %}

{% block contents %}
<div id="mvwrap">
  <form id="steps" method="POST">
    <div class="step mv_info">
      <div id="col_head">영화 선택</div>
      <div class="col_body">
        {% for tup in movies %}
        <span>
          <input type='radio' name='movie' class='movie'>
          <label for="movie" class='mv_title'>{{ tup[1] }}</label>
          <span class='hidden_info' style="visibility: hidden;">{{ tup }}</span>
          </input>
        </span>
        {% endfor %}
      </div>
    </div>
    <div class="step ci_info">
      <div id="col_head">영화관 선택</div>
      <div class="col_body">
        {% for tup in cinemas %}
        <span>
          <input type='radio' name='cinema' class='cinema'></input>
          <label for="cinema" class='cin_name'>{{ tup[1] }}</label>
          <span class='hidden_info' style="visibility: hidden;">{{ tup }}</span>
        </span>
        {% endfor %}
      </div>
    </div>
    <div class="step date_info">
      <div id="col_head">날짜 선택</div>
      <div class="col_body">
        {% for tup in dates %}
        <span>
          <input type='radio' name='date' class='date'></input>
          <label for="date">{{ tup[1] }}</label>
          <span class='hidden_info' style="visibility: hidden;">{{ tup }}</span>
        </span>
        {% endfor %}
      </div>
    </div>
    <div class="step time_info">
      <div id="col_head">시간/상영관 선택</div>
      <div class="col_body">
        <span>영화, 영화관, 날짜를 선택해주세요.</span>
        <p></p>
      </div>
    </div>
    <input type="submit" id='next_btn' value="좌석 선택">
  </form>
</div>
{% endblock %}

{% block js %}
<script type="text/javascript">
  const mv_radios = document.querySelectorAll(".movie"),
    cin_radios = document.querySelectorAll(".cinema"),
    dat_radios = document.querySelectorAll(".date");

  function paintMv(id, Checked){

  }

  function handleChecked() {
    const mv = event.target, 
      mvSpan = mv.parentNode,
      info = mvSpan.querySelector(".hidden_info").textContent;

    const whichChecked = mv.className; 

    console.log(whichChecked, "checked");
    console.log(info);
    paintAvailable(id, whichChecked);
  }

  function init() {
    mv_radios.forEach(Element => Element.addEventListener('click', handleChecked));
    cin_radios.forEach(Element => Element.addEventListener('click', handleChecked));
    dat_radios.forEach(Element => Element.addEventListener('click', handleChecked));
  }

  init();
</script>
{% endblock %}